[Rainmeter]
Update=-1
AccurateText=1
RIghtMOuseUpAction=[!SkinCustomMenu]
ContextTitle=Refresh
ContextAction=[!Refresh]
ContextTitle2=Settings
ContextAction2=[!ActivateConfig "PowerToys+\@settings" "MultiRun.ini"][!UpdateMeasure Unload]
;OnUnfocusAction=[!UpdateMeasure Unload]
SkinWidth=(#GlobalW#+2)
SkinHeight=(#GlobalH#+2)
OnRefreshAction=!WriteKeyValue #CURRENTCONFIG# Active 0 "%APPDATA%\Rainmeter\Rainmeter.ini"

; [ExtractOptions]
; Measure=Script
; ScriptFile=Test.lua
; IncFile=#@#MultiRunExtracted.inc
; Number=15
; SectionName=Variables
; Option0=A

[Variables]
ResetIco=[!SetOption Ico ImageName "#@#Icons\Global\PowershellL.png"][!SetOption Title Text "Run"][!UpdateMeter *][!Redraw]
InputString=
Manual=
GRefresh=[!DeactivateConfig "PowerToys+\PermaClip"][!Refresh "PowerToys+\Dashboard"][!Refresh "PowerToys+\DesktopSwitch"][!Refresh "PowerToys+\SnipControl"][!Refresh "PowerToys+\MultiRun"][!Refresh "PowerToys+\StartCenter"][!Delay 100][!ActivateConfig "PowerToys+\PermaClip" Main.ini]
@include=#@#MultiRunVariables.inc
@includeTaskbar=#@#TaskbarState.inc

; [FrostedGlass]
; Measure=Plugin
; Plugin=FrostedGlass
; Type=#ActualBlur#
; DynamicVariables=1
; ;Acrylic | Blur

[OnActualLoad]
Measure=Calc
Formula=Counter
IfEqualValue=1
IfEqualAction=[!Zpos 1][!Draggable 0][!KeepOnScreen 0][!FadeDuration 100][!Move (#SCREENAREAWIDTH#/2-#GlobalW#/2) 10]["#@#Actions\AHKOld.exe" "#@#Actions\Source Code\MultiRun.ahk"][!Delay 16][!EnableMeasureGroup NoUpdateOnLoad][!DisableMeasure #CURRENTSECTION#][!EnableMeasure OnLoad][!Hide]
IfAboveValue=1
IfAboveAction=[!Hide][!Delay 100][!EnableMeasure Unload][!Delay 16][!EnableMeasureGroup NoUpdateOnLoad]
UpdateDivider=-1

[MainFilter]
Measure=String
String=#InputString#
IfMatch=^#Prefix#r$
ifmatchaction=[!Refresh]
ifmatch2=^#Prefix#s\s.*
ifmatchaction2=#browserlink#[!UpdateMeasure Unload]
ifmatch3=^#Prefix#r\s.*
ifmatchaction3=[ArgsFilter]
ifmatch4=^#Prefix#l$
ifmatchaction4=[!About]
ifmatch5=^#Prefix#c\s.*
ifmatchaction5=[!ActivateConfig "PowerToys+\@Settings" "[ArgsFilter].ini"][!Updatemeasure Unload]
ifmatch6=^#Prefix#c$
ifmatchaction6=[!ActivateConfig "PowerToys+\@Settings" "Global.ini"][!Updatemeasure Unload]
ifmatch7=^#Prefix#t\s.*
ifmatchaction7=[!UpdateMeasure "toggle[ArgsFilter]"][!Updatemeasure Unload]
ifmatch8=^#Prefix#d\s.*
ifmatchaction8=["#Dictlink#[ArgsFilter]"][!Updatemeasure Unload]
ifmatch9=^#Prefix#m$
ifmatchaction9=[!Delay 100][!CommandMeasure Input "ExecuteBatch 2"][!SetOption Ico ImageName "#@#Icons\Global\RainmeterL.png"][!SetOption Title Text "Rainmeter manual"][!UpdateMeter *][!Redraw]
ifmatch10=^#Prefix#k\s.*
ifmatchaction10=["#@#Actions\TaskKiller.exe" "[ArgsFilter].exe"][!Updatemeasure Unload]
ifmatch11=^#Prefix#explorer$
ifmatchaction11=["#@#Actions\RestartExplorer.bat"][!Updatemeasure Unload]
ifmatch12=^#Prefix#vol\s.*
ifmatchaction12=[!CommandMeasure "MeasureWin7Audio" "SetVolume [ArgsFilter]"][!Updatemeasure Unload]
ifmatch13=^#Prefix#voli\s.*
ifmatchaction13=[!CommandMeasure "MeasureWin7Audio" "SetOutputIndex [ArgsFilter]"][!Updatemeasure Unload]
ifmatch14=^#Prefix#volt\s.*
ifmatchaction14=[!CommandMeasure "MeasureWin7Audio" "Toggle[ArgsFilter]"][!Updatemeasure Unload]
ifmatch15=^#Prefix#yt\s.*
ifmatchaction15=["https://www.youtube.com/results?search_query=[ArgsFilter]"][!Updatemeasure Unload]
ifmatch16=^#Prefix#mon\s.*
ifmatchaction16=[!UpdateMeasure ChangeMonitor][!Updatemeasure Unload]
ifmatch17=^#Prefix#h$
ifmatchaction17=["https://github.com/EnhancedJax/PowerToysPlus/wiki/Wiki#multirun-commands"][!Updatemeasure Unload]
ifmatch18=\s*
IfNotMatchAction18=[!Updatemeasure Unload]
ifmatch19=^#prefix#.*
ifnotmatchaction19=["#InputString#"][!Updatemeasure Unload]
ifmatch20=^#Prefix#r\s.*
ifmatchaction20=[!Delay 20][!UpdateMeasure Unload]
; ifmatch18=^#Prefix#
; ifmatchaction18=[!Updatemeasure Unload]
; ifmatch19=^#Prefix#
; ifmatchaction19=[!Updatemeasure Unload]
; ifmatch20=^#Prefix#
; ifmatchaction20=[!Updatemeasure Unload]
; ifmatch21=^#Prefix#
; ifmatchaction21=[!Updatemeasure Unload]
; ifmatch22=^#Prefix#
; ifmatchaction22=[!Updatemeasure Unload]
; ifmatch23=^#Prefix#
; ifmatchaction23=[!Updatemeasure Unload]
IfMatchMode=1
Group=NoUpdateOnLoad
disabled=1
DynamicVariables=1

[ArgsFilter]
Measure=String
String=#InputString#
RegExpSubstitute=1
Group=NoUpdateOnLoad
disabled=1
DynamicVariables=1
OnUpdateAction=[!Delay 100][!UpdateMeasure MainFilter]
Substitute="^[^\s]+":"","\.exe":"","^\s":""

[ManualFilter]
Measure=String
String=#manual#
IfMatch=^plugins|^plugin
IfMatchAction=["https://docs.rainmeter.net/manual/plugins/[ManualPathFilter]"]
IfMatch2=^meters|^meter
IfMatchAction2=["https://docs.rainmeter.net/manual/meters/[ManualPathFilter]"]
IfMatch3=^generaloptions|^generaloption
IfMatchAction3=["https://docs.rainmeter.net/manual/meters/general-options/[ManualPathFilter]/"]
IfMatch4=^inline
IfMatchAction4=["https://docs.rainmeter.net/manual/meters/string/inline/"]
IfMatch5=^skins
IfMatchAction5=["https://docs.rainmeter.net/manual/skins/[ManualPathFilter]"]
IfMatch6=^conditions|if|condition|match
IfMatchAction6=["https://docs.rainmeter.net/manual/measures/general-options/[ManualPathFilter]"]
IfMatch7=^measure|^measures
IfMatchAction7=["https://docs.rainmeter.net/manual/measures/[ManualPathFilter]"]
IfMatch8=^bangs|^bang
IfMatchAction8=["https://docs.rainmeter.net/manual/bangs/#[ManualPathFilter]"]
IfMatch9=^#prefix#$
IfMatchAction9=#resetIco#[!Delay 100][!CommandMeasure Input "ExecuteBatch All"]
IfNotMatchAction9=[!updatemeasure unload]
IfMatchMode=1
Group=NoUpdateOnLoad
disabled=1
DynamicVariables=1

[ManualPathFilter]
Measure=String
String=#manual#
RegExpSubstitute=1
Group=NoUpdateOnLoad
disabled=1
DynamicVariables=1
OnUpdateAction=[!Delay 100][!UpdateMeasure ManualFilter]
Substitute="plugins|plugin|meters|meter|generaloption|generaloptions|skins|conditions|if|condition|match|measure|measures|bangs|bang":"","^\s":""

[ChangeMonitor]
Measure=String
String=[ManualFilter]
DynamicVariables=1
OnUpdateAction=["DisplaySwitch.exe" "/[ChangeMonitor]"]
Group=NoUpdateOnLoad
disabled=1
Substitute="1|Primary|Left":"internal","2x|Duplicate|Copy|Same":"double","All|Two":"extend","2|Secondary|Right":"external"

;///////////////////////////////////////////////////////////////////////////////////////////////////
;                                              Loading and unloading
;///////////////////////////////////////////////////////////////////////////////////////////////////

[Unload]
Measure=String
String=#Animated#
IfMatch=0
IfMatchMode=1
ifmatchaction=[!Hide][!EnableMeasureGroup UpdateOnLoad]
IfNotMatchAction=[!HideFade][!EnableMeasureGroup UpdateOnLoad]
OnUpdateAction=
OnUpdateAction=#ResetIco#
DIsabled=1

[OnLoad]
Measure=String
IfMatch=0
IfMatchMode=1
ifmatchaction=[!Show]["#@#Actions\RainFocus.exe" "#CURRENTCONFIG#"][!Delay 100][!CommandMeasure Input "ExecuteBatch 1"][!EnableMeasure Unload]
IfNotMatchAction=[!ShowFade]["#@#Actions\RainFocus.exe" "#CURRENTCONFIG#"][!Delay 100][!CommandMeasure Input "ExecuteBatch 1"][!EnableMeasure Unload]
Disabled=1
Group=NoUpdateOnLoad | UpdateonLoad
UpdateDivider=-1

[ToggleTaskbar]
measure=string
string=#TaskbarBool#
Group=NoUpdateOnLoad
Disabled=1
IfMatchMode=1
IfMatch=1
IfMatchAction=[!WriteKeyValue Variables TaskbarBool "0" #@#TaskbarState.inc]["#@#Actions\RestartExplorer.bat"][!Refresh]
IfNotMatchAction=[!WriteKeyValue Variables TaskbarBool "1" #@#TaskbarState.inc][!ActivateConfig "PowerToys+\Startup"][!Refresh]
OnUpdateAction=[!Refresh "PowerToys+\Startup"]

[ToggleApptray]
measure=string
string=#ApptrayBool#
Group=NoUpdateOnLoad
Disabled=1
IfMatchMode=1
IfMatch=1
IfMatchAction=[!WriteKeyValue Variables ApptrayBool "0" #@#TaskbarState.inc][!Refresh]
IfNotMatchAction=[!WriteKeyValue Variables ApptrayBool "1" #@#TaskbarState.inc][!ActivateConfig "PowerToys+\Startup"][!Refresh]
OnUpdateAction=[!Refresh "PowerToys+\Startup"]

[ToggleCorner]
measure=string
string=#Corner#
Group=NoUpdateOnLoad
Disabled=1
IfMatchMode=1
IfMatch=1
IfMatchAction=[!WriteKeyValue Variables Corner "0" #@#GlobalVars.inc][!Refresh]
IfNotMatchAction=[!WriteKeyValue Variables Corner "1" #@#GlobalVars.inc][!Refresh]
OnUpdateAction=#GRefresh#

[ToggleEdge]
measure=string
string=#Edge#
Group=NoUpdateOnLoad
Disabled=1
IfMatchMode=1
IfMatch=1
IfMatchAction=[!WriteKeyValue Variables Edge "0" #@#GlobalVars.inc][!Refresh]
IfNotMatchAction=[!WriteKeyValue Variables Edge "1" #@#GlobalVars.inc][!Refresh]
OnUpdateAction=#GRefresh#

[SettingsImport]
measure=string
string=#Icon#
IfMatchMode=1
IfMatch=1
IfMatchAction=[!ShowMeter Ico][!UpdateMeter Ico][!Redraw]

[MeasureWin7Audio]
Measure=Plugin
Plugin=Win7AudioPlugin

[ToggleInternet]
Measure=PLUGIN
Plugin=SysInfo
SysInfoType=INTERNET_CONNECTIVITY
Group=NoUpdateOnLoad
Disabled=1
RegExpSubstitute=1
IfCondition=toggleInternet = -1
IfTrueAction=[!CommandMeasure InternetOn "Run"][!Log InternetOn]
IfFalseAction=[!CommandMeasure InternetOff "Run"][!Log InternetOff]
IfConditionMode=1
[InternetOff]
Measure=Plugin
Plugin=RunCommand
Parameter=ipconfig /release
State=Hide
[InternetOn]
Measure=Plugin
Plugin=RunCommand
Parameter=ipconfig /renew
State=Hide

;///////////////////////////////////////////////////////////////////////////////////////////////////
;                                              Loading and unloading
;///////////////////////////////////////////////////////////////////////////////////////////////////

[Background]
Meter=Shape
X=1
Y=1
Shape=Rectangle 0,0,#GlobalW#,#GlobalH#,(#edge#*15),(#edge#*15) | StrokeWidth 1 | Stroke Color #Border#,#Alpha# | Fill Color #Color#,#Alpha#

[Ico]
Meter=Image
X=(#GlobalW#/2-100/2)
Y=r
W=100
H=#GlobalH#
PreserveAspectRatio=2
ImageName=#@#Icons\Global\PowershellL.png
Greyscale=1
ImageAlpha=50
Hidden=1


[Title]
Meter=String
X=(#GlobalW#/2)
Y=15r
StringAlign=CenterCenter
Text=Run
FontSize=10
MeterStyle=RegularText
FontColor=#DarkColor#


[InputBox1]
Meter=Shape
Y=25r

Shape=Rectangle 30,0,(#GlobalW#-30*2),30,(#Corner#*3),(#Corner#*3) | StrokeWidth 1 | Stroke Color #Accent# | Fill Color #BoxColor#

[Input]
Measure=Plugin
Plugin=InputText
SolidColor=#BoxColor#
FontColor=#FontColor#
FontFace=#Font#
FontSize=10
StringAlign=Left
W=(#GlobalW#-30*2-8)
x=(30+4)
Y=45
DefaultValue=""
Command1=[!SetVariable InputString "$UserInput$"][!UpdateMeasure ArgsFilter]
Command2=[!SetVariable Manual "$UserInput$"][!UpdateMeasure ManualPathFilter]
ondismissaction=[!UpdateMeasure Unload]
FocusDismiss=1